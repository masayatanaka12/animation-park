"use strict";

// scroll class add
jQuery(window).on("load scroll resize", function () {}); // scroll class add END

// jQuery start
jQuery(function ($) {
  // SP 100vh(スクロールバー対策)
  // $('.loadingLogo').css('height',$(window).height());

  // Smooth scroll
  // ページ内リンク
  var width = $(window).width();
  if (width <= 1023) {
    var headerHight = 60; //ヘッダの高さ
  } else {
    var headerHight = 100; //ヘッダの高さ
  }
  $('a[href^="#"]').click(function () {
    var speed = 800;
    var href = $(this).attr("href");
    var target = $(href == "#" || href == "" ? 'html' : href);
    var position = target.offset().top - headerHight;
    $("html, body").animate({
      scrollTop: position
    }, speed, "swing");
    return false;
  });
});
// jQuery End

// 1. 全てのラッパー要素を取得
document.addEventListener('DOMContentLoaded', function () {
  var wrappers = document.querySelectorAll('.galleryCard__videoWrap');
  wrappers.forEach(function (wrap) {
    var video = wrap.querySelector('video');
    var img = wrap.querySelector('.galleryModal__img');

    // video または img が見つからなければスキップ
    if (!video || !img) return;
    wrap.addEventListener('mouseenter', function () {
      img.style.display = 'none';
      video.play();
    });
    wrap.addEventListener('mouseleave', function () {
      video.pause();
      video.currentTime = 0;
      img.style.display = ''; // 必要に応じて 'block' などを指定
    });
  });
});
document.addEventListener('DOMContentLoaded', function () {
  var wrappers = document.querySelectorAll('.galleryModal__videoWrap');
  wrappers.forEach(function (wrap) {
    var video = wrap.querySelector('video');
    var img = wrap.querySelector('.galleryModal__img');

    // video または img が見つからなければスキップ
    if (!video || !img) return;
    wrap.addEventListener('mouseenter', function () {
      img.style.display = 'none';
      video.play();
    });
    wrap.addEventListener('mouseleave', function () {
      video.pause();
      video.currentTime = 0;
      img.style.display = ''; // 必要に応じて 'block' などを指定
    });
  });
});

// ▼ Playボタンを押したら先頭から再生（SP向けも含む）

document.querySelectorAll('.galleryModal__play').forEach(function (button) {
  var container = button.parentElement; // .galleryModal__videoContent
  var video = container.querySelector('.js-video');
  var img = container.querySelector('.galleryModal__img');
  if (!video) return;
  button.addEventListener('click', function () {
    // 画像を非表示にする
    if (img) {
      img.style.display = 'none';
    }

    // 動画を先頭に戻して再生
    video.currentTime = 0;
    video.play();
  });
});
document.querySelectorAll('.galleryCard__play').forEach(function (button) {
  var container = button.parentElement; // .galleryModal__videoContent
  var video = container.querySelector('.js-video');
  var img = container.querySelector('.galleryModal__img');
  if (!video) return;
  button.addEventListener('click', function () {
    // 画像を非表示にする
    if (img) {
      img.style.display = 'none';
    }

    // 動画を先頭に戻して再生
    video.currentTime = 0;
    video.play();
  });
});
document.querySelectorAll('.copy-btn').forEach(function (btn) {
  btn.addEventListener('click', function () {
    // ① ボタンの親要素内の<code>を探す
    var code = btn.closest('.topGalleryModal__detail').querySelector('code');
    if (!code) return;

    // ② コピー
    navigator.clipboard.writeText(code.innerText).then(function () {
      btn.innerText = 'Copied!';
      setTimeout(function () {
        return btn.innerText = 'Copy';
      }, 1200);
    });
  });
});
document.querySelectorAll('.topGalleryModal__item').forEach(function (tab) {
  tab.addEventListener('click', function () {
    // Get the parent modal wrapper
    var modalWrapper = this.closest('.topGalleryModal__wrapper');
    if (!modalWrapper) return;

    // Remove active class from all tabs in this modal
    modalWrapper.querySelectorAll('.topGalleryModal__item').forEach(function (t) {
      return t.classList.remove('active');
    });
    // Hide all code panels in this modal
    modalWrapper.querySelectorAll('.topGalleryModal__code').forEach(function (c) {
      return c.style.display = 'none';
    });

    // Add active class to clicked tab
    this.classList.add('active');
    // Show the corresponding code panel
    var target = this.getAttribute('data-tab');
    modalWrapper.querySelector(".topGalleryModal__code[data-tab=\"".concat(target, "\"]")).style.display = 'block';
  });
});
document.querySelectorAll('.galleryCard__btn--code').forEach(function (btn) {
  btn.addEventListener('click', function () {
    var modal = document.querySelector('.topGalleryModal');
    var bg = document.querySelector('.topGalleryModal__bg');
    var modalId = this.getAttribute('data-modal');

    // Hide all modal wrappers first
    document.querySelectorAll('.topGalleryModal__wrapper').forEach(function (wrapper) {
      wrapper.style.display = 'none';
    });

    // Show the selected modal wrapper
    var selectedWrapper = document.querySelector(".topGalleryModal__wrapper[data-modal-content=\"".concat(modalId, "\"]"));
    if (selectedWrapper) {
      selectedWrapper.style.display = 'block';

      // Initialize tabs for this modal
      var tabs = selectedWrapper.querySelectorAll('.topGalleryModal__item');
      var codePanels = selectedWrapper.querySelectorAll('.topGalleryModal__code');

      // Reset all tabs and panels
      tabs.forEach(function (tab) {
        return tab.classList.remove('active');
      });
      codePanels.forEach(function (panel) {
        return panel.style.display = 'none';
      });

      // Activate first tab and show its content
      if (tabs.length > 0) {
        tabs[0].classList.add('active');
        var firstPanel = selectedWrapper.querySelector('.topGalleryModal__code[data-tab="0"]');
        if (firstPanel) {
          firstPanel.style.display = 'block';
        }
      }
    }
    modal.classList.remove('closing');
    modal.classList.add('active');
    bg.classList.add('active');
  });
});

// Close modal functionality
document.querySelectorAll('.topGalleryModal__close').forEach(function (closeBtn) {
  closeBtn.addEventListener('click', function () {
    var modal = document.querySelector('.topGalleryModal');
    var bg = document.querySelector('.topGalleryModal__bg');

    // First remove active class to trigger closing animation
    modal.classList.remove('active');
    // Then add closing class for the animation
    modal.classList.add('closing');
    bg.classList.remove('active');

    // Wait for animation to complete before hiding
    setTimeout(function () {
      modal.classList.remove('closing');
      document.querySelectorAll('.topGalleryModal__wrapper').forEach(function (wrapper) {
        wrapper.style.display = 'none';
      });
    }, 700);
  });
});
document.addEventListener('DOMContentLoaded', function () {
  var modalSample = document.querySelector('.topGallerySample');
  var scroller = modalSample; // scroll container

  // IntersectionObserver の設定
  var observer = new IntersectionObserver(function (entries, obs) {
    entries.forEach(function (entry) {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        obs.unobserve(entry.target);
      }
    });
  }, {
    root: scroller,
    threshold: 0.1
  });

  // アニメーション状態をリセットして再監視する関数
  function resetAnimations() {
    fadeEls.forEach(function (el) {
      el.classList.remove('is-visible');
      observer.observe(el);
    });
  }

  // モーダルを開く／閉じるボタン
  document.querySelectorAll('.galleryCard__btn--sample').forEach(function (btn) {
    btn.addEventListener('click', function () {
      var isNowOpen = modalSample.classList.toggle('active');
      document.body.style.overflow = isNowOpen ? 'hidden' : '';
      if (isNowOpen) {
        // 開いた直後にリセット
        modalSample.scrollTop = 0;
        resetAnimations();
      }
    });
  });

  // モーダル内の「閉じる」ボタン
  document.querySelectorAll('.topGallerySample__close').forEach(function (closeBtn) {
    closeBtn.addEventListener('click', function () {
      modalSample.classList.remove('active');
      document.body.style.overflow = '';
      // 閉じたときもリセットしておくと安心
      modalSample.scrollTop = 0;
      resetAnimations();
    });
  });
});
document.addEventListener('DOMContentLoaded', function () {
  var options = {
    root: null,
    rootMargin: '0px',
    threshold: 0.3
  };
  var callback = function callback(entries, observer) {
    entries.forEach(function (entry) {
      if (entry.isIntersecting) {
        entry.target.classList.add('js-mask-animation');
        observer.unobserve(entry.target);
      }
    });
  };
  var observer = new IntersectionObserver(callback, options);
  document.querySelectorAll('.sample01__img').forEach(function (elm) {
    observer.observe(elm);
  });
});
"use strict";

document.addEventListener('DOMContentLoaded', function () {
  var button = document.querySelector('.sample02__button');
  if (button) {
    button.addEventListener('click', function () {
      var isExpanded = button.getAttribute('aria-expanded') === 'true';
      button.setAttribute('aria-expanded', !isExpanded);
      button.classList.toggle('active');
      var textElement = button.querySelector('.text');
      if (textElement) {
        textElement.textContent = isExpanded ? 'MENU' : 'CLOSE';
      }
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UuanMiLCJzYW1wbGUwMi5qcyJdLCJuYW1lcyI6WyJqUXVlcnkiLCJ3aW5kb3ciLCJvbiIsIiQiLCJ3aWR0aCIsImhlYWRlckhpZ2h0IiwiY2xpY2siLCJzcGVlZCIsImhyZWYiLCJhdHRyIiwidGFyZ2V0IiwicG9zaXRpb24iLCJvZmZzZXQiLCJ0b3AiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwid3JhcHBlcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsIndyYXAiLCJ2aWRlbyIsInF1ZXJ5U2VsZWN0b3IiLCJpbWciLCJzdHlsZSIsImRpc3BsYXkiLCJwbGF5IiwicGF1c2UiLCJjdXJyZW50VGltZSIsImJ1dHRvbiIsImNvbnRhaW5lciIsInBhcmVudEVsZW1lbnQiLCJidG4iLCJjb2RlIiwiY2xvc2VzdCIsIm5hdmlnYXRvciIsImNsaXBib2FyZCIsIndyaXRlVGV4dCIsImlubmVyVGV4dCIsInRoZW4iLCJzZXRUaW1lb3V0IiwidGFiIiwibW9kYWxXcmFwcGVyIiwidCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImMiLCJhZGQiLCJnZXRBdHRyaWJ1dGUiLCJjb25jYXQiLCJtb2RhbCIsImJnIiwibW9kYWxJZCIsIndyYXBwZXIiLCJzZWxlY3RlZFdyYXBwZXIiLCJ0YWJzIiwiY29kZVBhbmVscyIsInBhbmVsIiwibGVuZ3RoIiwiZmlyc3RQYW5lbCIsImNsb3NlQnRuIiwibW9kYWxTYW1wbGUiLCJzY3JvbGxlciIsIm9ic2VydmVyIiwiSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiLCJlbnRyaWVzIiwib2JzIiwiZW50cnkiLCJpc0ludGVyc2VjdGluZyIsInVub2JzZXJ2ZSIsInJvb3QiLCJ0aHJlc2hvbGQiLCJyZXNldEFuaW1hdGlvbnMiLCJmYWRlRWxzIiwiZWwiLCJvYnNlcnZlIiwiaXNOb3dPcGVuIiwidG9nZ2xlIiwiYm9keSIsIm92ZXJmbG93Iiwib3B0aW9ucyIsInJvb3RNYXJnaW4iLCJjYWxsYmFjayIsImVsbSIsImlzRXhwYW5kZWQiLCJzZXRBdHRyaWJ1dGUiLCJ0ZXh0RWxlbWVudCIsInRleHRDb250ZW50Il0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0FBLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDLENBQUNDLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxZQUFZLENBR3BELENBQUMsQ0FBQyxDQUFDLENBQUM7O0FBRUo7QUFDQUYsTUFBTSxDQUFDLFVBQVVHLENBQUMsRUFBRTtFQUVsQjtFQUNBOztFQUdBO0VBQ0E7RUFDQSxJQUFJQyxLQUFLLEdBQUdELENBQUMsQ0FBQ0YsTUFBTSxDQUFDLENBQUNHLEtBQUssQ0FBQyxDQUFDO0VBQzdCLElBQUlBLEtBQUssSUFBSSxJQUFJLEVBQUU7SUFDakIsSUFBSUMsV0FBVyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0VBQ3hCLENBQUMsTUFBTTtJQUNMLElBQUlBLFdBQVcsR0FBRyxHQUFHLENBQUMsQ0FBQztFQUN6QjtFQUVBRixDQUFDLENBQUMsY0FBYyxDQUFDLENBQUNHLEtBQUssQ0FBQyxZQUFZO0lBQ2xDLElBQUlDLEtBQUssR0FBRyxHQUFHO0lBQ2YsSUFBSUMsSUFBSSxHQUFHTCxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUNNLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDL0IsSUFBSUMsTUFBTSxHQUFHUCxDQUFDLENBQUNLLElBQUksSUFBSSxHQUFHLElBQUlBLElBQUksSUFBSSxFQUFFLEdBQUcsTUFBTSxHQUFHQSxJQUFJLENBQUM7SUFDekQsSUFBSUcsUUFBUSxHQUFHRCxNQUFNLENBQUNFLE1BQU0sQ0FBQyxDQUFDLENBQUNDLEdBQUcsR0FBR1IsV0FBVztJQUNoREYsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDVyxPQUFPLENBQUM7TUFDdEJDLFNBQVMsRUFBRUo7SUFDYixDQUFDLEVBQUVKLEtBQUssRUFBRSxPQUFPLENBQUM7SUFDbEIsT0FBTyxLQUFLO0VBQ2QsQ0FBQyxDQUFDO0FBSUosQ0FBQyxDQUFDO0FBQ0Y7O0FBR0E7QUFD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OlsiLy8gc2Nyb2xsIGNsYXNzIGFkZFxualF1ZXJ5KHdpbmRvdykub24oXCJsb2FkIHNjcm9sbCByZXNpemVcIiwgZnVuY3Rpb24gKCkge1xuXG5cbn0pOyAvLyBzY3JvbGwgY2xhc3MgYWRkIEVORFxuXG4vLyBqUXVlcnkgc3RhcnRcbmpRdWVyeShmdW5jdGlvbiAoJCkge1xuXG4gIC8vIFNQIDEwMHZoKOOCueOCr+ODreODvOODq+ODkOODvOWvvuetlilcbiAgLy8gJCgnLmxvYWRpbmdMb2dvJykuY3NzKCdoZWlnaHQnLCQod2luZG93KS5oZWlnaHQoKSk7XG5cblxuICAvLyBTbW9vdGggc2Nyb2xsXG4gIC8vIOODmuODvOOCuOWGheODquODs+OCr1xuICB2YXIgd2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcbiAgaWYgKHdpZHRoIDw9IDEwMjMpIHtcbiAgICB2YXIgaGVhZGVySGlnaHQgPSA2MDsgLy/jg5jjg4Pjg4Djga7pq5jjgZVcbiAgfSBlbHNlIHtcbiAgICB2YXIgaGVhZGVySGlnaHQgPSAxMDA7IC8v44OY44OD44OA44Gu6auY44GVXG4gIH1cblxuICAkKCdhW2hyZWZePVwiI1wiXScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc3BlZWQgPSA4MDA7XG4gICAgdmFyIGhyZWYgPSAkKHRoaXMpLmF0dHIoXCJocmVmXCIpO1xuICAgIHZhciB0YXJnZXQgPSAkKGhyZWYgPT0gXCIjXCIgfHwgaHJlZiA9PSBcIlwiID8gJ2h0bWwnIDogaHJlZik7XG4gICAgdmFyIHBvc2l0aW9uID0gdGFyZ2V0Lm9mZnNldCgpLnRvcCAtIGhlYWRlckhpZ2h0O1xuICAgICQoXCJodG1sLCBib2R5XCIpLmFuaW1hdGUoe1xuICAgICAgc2Nyb2xsVG9wOiBwb3NpdGlvblxuICAgIH0sIHNwZWVkLCBcInN3aW5nXCIpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG5cblxuXG59KTtcbi8vIGpRdWVyeSBFbmRcblxuXG4vLyAxLiDlhajjgabjga7jg6njg4Pjg5Hjg7zopoHntKDjgpLlj5blvpdcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG4gIGNvbnN0IHdyYXBwZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdhbGxlcnlDYXJkX192aWRlb1dyYXAnKTtcblxuICB3cmFwcGVycy5mb3JFYWNoKHdyYXAgPT4ge1xuICAgIGNvbnN0IHZpZGVvID0gd3JhcC5xdWVyeVNlbGVjdG9yKCd2aWRlbycpO1xuICAgIGNvbnN0IGltZyAgID0gd3JhcC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeU1vZGFsX19pbWcnKTtcblxuICAgIC8vIHZpZGVvIOOBvuOBn+OBryBpbWcg44GM6KaL44Gk44GL44KJ44Gq44GR44KM44Gw44K544Kt44OD44OXXG4gICAgaWYgKCF2aWRlbyB8fCAhaW1nKSByZXR1cm47XG5cbiAgICB3cmFwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICBpbWcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIHZpZGVvLnBsYXkoKTtcbiAgICB9KTtcblxuICAgIHdyYXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgIHZpZGVvLnBhdXNlKCk7XG4gICAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XG4gICAgICBpbWcuc3R5bGUuZGlzcGxheSA9ICcnOyAvLyDlv4XopoHjgavlv5zjgZjjgaYgJ2Jsb2NrJyDjgarjganjgpLmjIflrppcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbiAgY29uc3Qgd3JhcHBlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ2FsbGVyeU1vZGFsX192aWRlb1dyYXAnKTtcblxuICB3cmFwcGVycy5mb3JFYWNoKHdyYXAgPT4ge1xuICAgIGNvbnN0IHZpZGVvID0gd3JhcC5xdWVyeVNlbGVjdG9yKCd2aWRlbycpO1xuICAgIGNvbnN0IGltZyAgID0gd3JhcC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeU1vZGFsX19pbWcnKTtcblxuICAgIC8vIHZpZGVvIOOBvuOBn+OBryBpbWcg44GM6KaL44Gk44GL44KJ44Gq44GR44KM44Gw44K544Kt44OD44OXXG4gICAgaWYgKCF2aWRlbyB8fCAhaW1nKSByZXR1cm47XG5cbiAgICB3cmFwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICBpbWcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIHZpZGVvLnBsYXkoKTtcbiAgICB9KTtcblxuICAgIHdyYXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgIHZpZGVvLnBhdXNlKCk7XG4gICAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XG4gICAgICBpbWcuc3R5bGUuZGlzcGxheSA9ICcnOyAvLyDlv4XopoHjgavlv5zjgZjjgaYgJ2Jsb2NrJyDjgarjganjgpLmjIflrppcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuXG5cbiAgLy8g4pa8IFBsYXnjg5zjgr/jg7PjgpLmirzjgZfjgZ/jgonlhYjpoK3jgYvjgonlho3nlJ/vvIhTUOWQkeOBkeOCguWQq+OCgO+8iVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ2FsbGVyeU1vZGFsX19wbGF5JykuZm9yRWFjaChidXR0b24gPT4ge1xuICBjb25zdCBjb250YWluZXIgPSBidXR0b24ucGFyZW50RWxlbWVudDsgLy8gLmdhbGxlcnlNb2RhbF9fdmlkZW9Db250ZW50XG4gIGNvbnN0IHZpZGVvICAgICA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuanMtdmlkZW8nKTtcbiAgY29uc3QgaW1nICAgICAgID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5TW9kYWxfX2ltZycpO1xuICBpZiAoIXZpZGVvKSByZXR1cm47XG5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIC8vIOeUu+WDj+OCkumdnuihqOekuuOBq+OBmeOCi1xuICAgIGlmIChpbWcpIHtcbiAgICAgIGltZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cblxuICAgIC8vIOWLleeUu+OCkuWFiOmgreOBq+aIu+OBl+OBpuWGjeeUn1xuICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gMDtcbiAgICB2aWRlby5wbGF5KCk7XG4gIH0pO1xufSk7XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5nYWxsZXJ5Q2FyZF9fcGxheScpLmZvckVhY2goYnV0dG9uID0+IHtcbiAgY29uc3QgY29udGFpbmVyID0gYnV0dG9uLnBhcmVudEVsZW1lbnQ7IC8vIC5nYWxsZXJ5TW9kYWxfX3ZpZGVvQ29udGVudFxuICBjb25zdCB2aWRlbyAgICAgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmpzLXZpZGVvJyk7XG4gIGNvbnN0IGltZyAgICAgICA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeU1vZGFsX19pbWcnKTtcbiAgaWYgKCF2aWRlbykgcmV0dXJuO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAvLyDnlLvlg4/jgpLpnZ7ooajnpLrjgavjgZnjgotcbiAgICBpZiAoaW1nKSB7XG4gICAgICBpbWcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG5cbiAgICAvLyDli5XnlLvjgpLlhYjpoK3jgavmiLvjgZfjgablho3nlJ9cbiAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XG4gICAgdmlkZW8ucGxheSgpO1xuICB9KTtcbn0pO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29weS1idG4nKS5mb3JFYWNoKGJ0biA9PiB7XG4gIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgIC8vIOKRoCDjg5zjgr/jg7Pjga7opqropoHntKDlhoXjga48Y29kZT7jgpLmjqLjgZlcbiAgICBjb25zdCBjb2RlID0gYnRuLmNsb3Nlc3QoJy50b3BHYWxsZXJ5TW9kYWxfX2RldGFpbCcpLnF1ZXJ5U2VsZWN0b3IoJ2NvZGUnKTtcbiAgICBpZiAoIWNvZGUpIHJldHVybjtcblxuICAgIC8vIOKRoSDjgrPjg5Tjg7xcbiAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb2RlLmlubmVyVGV4dCkudGhlbigoKSA9PiB7XG4gICAgICBidG4uaW5uZXJUZXh0ID0gJ0NvcGllZCEnO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiBidG4uaW5uZXJUZXh0ID0gJ0NvcHknLCAxMjAwKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuXG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b3BHYWxsZXJ5TW9kYWxfX2l0ZW0nKS5mb3JFYWNoKHRhYiA9PiB7XG4gIHRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgIC8vIEdldCB0aGUgcGFyZW50IG1vZGFsIHdyYXBwZXJcbiAgICBjb25zdCBtb2RhbFdyYXBwZXIgPSB0aGlzLmNsb3Nlc3QoJy50b3BHYWxsZXJ5TW9kYWxfX3dyYXBwZXInKTtcbiAgICBpZiAoIW1vZGFsV3JhcHBlcikgcmV0dXJuO1xuXG4gICAgLy8gUmVtb3ZlIGFjdGl2ZSBjbGFzcyBmcm9tIGFsbCB0YWJzIGluIHRoaXMgbW9kYWxcbiAgICBtb2RhbFdyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnLnRvcEdhbGxlcnlNb2RhbF9faXRlbScpLmZvckVhY2godCA9PiB0LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTtcbiAgICAvLyBIaWRlIGFsbCBjb2RlIHBhbmVscyBpbiB0aGlzIG1vZGFsXG4gICAgbW9kYWxXcmFwcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy50b3BHYWxsZXJ5TW9kYWxfX2NvZGUnKS5mb3JFYWNoKGMgPT4gYy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnKTtcbiAgICBcbiAgICAvLyBBZGQgYWN0aXZlIGNsYXNzIHRvIGNsaWNrZWQgdGFiXG4gICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAvLyBTaG93IHRoZSBjb3JyZXNwb25kaW5nIGNvZGUgcGFuZWxcbiAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS10YWInKTtcbiAgICBtb2RhbFdyYXBwZXIucXVlcnlTZWxlY3RvcihgLnRvcEdhbGxlcnlNb2RhbF9fY29kZVtkYXRhLXRhYj1cIiR7dGFyZ2V0fVwiXWApLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICB9KTtcbn0pO1xuXG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5nYWxsZXJ5Q2FyZF9fYnRuLS1jb2RlJykuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9wR2FsbGVyeU1vZGFsJyk7XG4gICAgY29uc3QgYmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9wR2FsbGVyeU1vZGFsX19iZycpO1xuICAgIGNvbnN0IG1vZGFsSWQgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1tb2RhbCcpO1xuICAgIFxuICAgIC8vIEhpZGUgYWxsIG1vZGFsIHdyYXBwZXJzIGZpcnN0XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvcEdhbGxlcnlNb2RhbF9fd3JhcHBlcicpLmZvckVhY2god3JhcHBlciA9PiB7XG4gICAgICB3cmFwcGVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gU2hvdyB0aGUgc2VsZWN0ZWQgbW9kYWwgd3JhcHBlclxuICAgIGNvbnN0IHNlbGVjdGVkV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC50b3BHYWxsZXJ5TW9kYWxfX3dyYXBwZXJbZGF0YS1tb2RhbC1jb250ZW50PVwiJHttb2RhbElkfVwiXWApO1xuICAgIGlmIChzZWxlY3RlZFdyYXBwZXIpIHtcbiAgICAgIHNlbGVjdGVkV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIFxuICAgICAgLy8gSW5pdGlhbGl6ZSB0YWJzIGZvciB0aGlzIG1vZGFsXG4gICAgICBjb25zdCB0YWJzID0gc2VsZWN0ZWRXcmFwcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy50b3BHYWxsZXJ5TW9kYWxfX2l0ZW0nKTtcbiAgICAgIGNvbnN0IGNvZGVQYW5lbHMgPSBzZWxlY3RlZFdyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnLnRvcEdhbGxlcnlNb2RhbF9fY29kZScpO1xuICAgICAgXG4gICAgICAvLyBSZXNldCBhbGwgdGFicyBhbmQgcGFuZWxzXG4gICAgICB0YWJzLmZvckVhY2godGFiID0+IHRhYi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7XG4gICAgICBjb2RlUGFuZWxzLmZvckVhY2gocGFuZWwgPT4gcGFuZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7XG4gICAgICBcbiAgICAgIC8vIEFjdGl2YXRlIGZpcnN0IHRhYiBhbmQgc2hvdyBpdHMgY29udGVudFxuICAgICAgaWYgKHRhYnMubGVuZ3RoID4gMCkge1xuICAgICAgICB0YWJzWzBdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICBjb25zdCBmaXJzdFBhbmVsID0gc2VsZWN0ZWRXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy50b3BHYWxsZXJ5TW9kYWxfX2NvZGVbZGF0YS10YWI9XCIwXCJdJyk7XG4gICAgICAgIGlmIChmaXJzdFBhbmVsKSB7XG4gICAgICAgICAgZmlyc3RQYW5lbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdjbG9zaW5nJyk7XG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgYmcuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gIH0pO1xufSk7XG5cbi8vIENsb3NlIG1vZGFsIGZ1bmN0aW9uYWxpdHlcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b3BHYWxsZXJ5TW9kYWxfX2Nsb3NlJykuZm9yRWFjaChmdW5jdGlvbihjbG9zZUJ0bikge1xuICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvcEdhbGxlcnlNb2RhbCcpO1xuICAgIGNvbnN0IGJnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvcEdhbGxlcnlNb2RhbF9fYmcnKTtcbiAgICBcbiAgICAvLyBGaXJzdCByZW1vdmUgYWN0aXZlIGNsYXNzIHRvIHRyaWdnZXIgY2xvc2luZyBhbmltYXRpb25cbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAvLyBUaGVuIGFkZCBjbG9zaW5nIGNsYXNzIGZvciB0aGUgYW5pbWF0aW9uXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnY2xvc2luZycpO1xuICAgIGJnLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIFxuICAgIC8vIFdhaXQgZm9yIGFuaW1hdGlvbiB0byBjb21wbGV0ZSBiZWZvcmUgaGlkaW5nXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdjbG9zaW5nJyk7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9wR2FsbGVyeU1vZGFsX193cmFwcGVyJykuZm9yRWFjaCh3cmFwcGVyID0+IHtcbiAgICAgICAgd3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgfSk7XG4gICAgfSwgNzAwKTtcbiAgfSk7XG59KTtcblxuXG5cblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICBjb25zdCBtb2RhbFNhbXBsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b3BHYWxsZXJ5U2FtcGxlJyk7XG4gIGNvbnN0IHNjcm9sbGVyICAgID0gbW9kYWxTYW1wbGU7ICAgICAgICAgICAgICAgICAvLyBzY3JvbGwgY29udGFpbmVyXG5cbiAgLy8gSW50ZXJzZWN0aW9uT2JzZXJ2ZXIg44Gu6Kit5a6aXG4gIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzLCBvYnMpID0+IHtcbiAgICBlbnRyaWVzLmZvckVhY2goZW50cnkgPT4ge1xuICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICAgIGVudHJ5LnRhcmdldC5jbGFzc0xpc3QuYWRkKCdpcy12aXNpYmxlJyk7XG4gICAgICAgIG9icy51bm9ic2VydmUoZW50cnkudGFyZ2V0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSwge1xuICAgIHJvb3Q6IHNjcm9sbGVyLFxuICAgIHRocmVzaG9sZDogMC4xXG4gIH0pO1xuXG4gIC8vIOOCouODi+ODoeODvOOCt+ODp+ODs+eKtuaFi+OCkuODquOCu+ODg+ODiOOBl+OBpuWGjeebo+imluOBmeOCi+mWouaVsFxuICBmdW5jdGlvbiByZXNldEFuaW1hdGlvbnMoKSB7XG4gICAgZmFkZUVscy5mb3JFYWNoKGVsID0+IHtcbiAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLXZpc2libGUnKTtcbiAgICAgIG9ic2VydmVyLm9ic2VydmUoZWwpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8g44Oi44O844OA44Or44KS6ZaL44GP77yP6ZaJ44GY44KL44Oc44K/44OzXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5nYWxsZXJ5Q2FyZF9fYnRuLS1zYW1wbGUnKS5mb3JFYWNoKGJ0biA9PiB7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgaXNOb3dPcGVuID0gbW9kYWxTYW1wbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gaXNOb3dPcGVuID8gJ2hpZGRlbicgOiAnJztcbiAgICAgIGlmIChpc05vd09wZW4pIHtcbiAgICAgICAgLy8g6ZaL44GE44Gf55u05b6M44Gr44Oq44K744OD44OIXG4gICAgICAgIG1vZGFsU2FtcGxlLnNjcm9sbFRvcCA9IDA7XG4gICAgICAgIHJlc2V0QW5pbWF0aW9ucygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICAvLyDjg6Ljg7zjg4Djg6vlhoXjga7jgIzplonjgZjjgovjgI3jg5zjgr/jg7NcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvcEdhbGxlcnlTYW1wbGVfX2Nsb3NlJykuZm9yRWFjaChjbG9zZUJ0biA9PiB7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBtb2RhbFNhbXBsZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgIC8vIOmWieOBmOOBn+OBqOOBjeOCguODquOCu+ODg+ODiOOBl+OBpuOBiuOBj+OBqOWuieW/g1xuICAgICAgbW9kYWxTYW1wbGUuc2Nyb2xsVG9wID0gMDtcbiAgICAgIHJlc2V0QW5pbWF0aW9ucygpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICByb290OiBudWxsLFxuICAgIHJvb3RNYXJnaW46ICcwcHgnLFxuICAgIHRocmVzaG9sZDogMC4zXG4gIH07XG5cbiAgY29uc3QgY2FsbGJhY2sgPSAoZW50cmllcywgb2JzZXJ2ZXIpID0+IHtcbiAgICBlbnRyaWVzLmZvckVhY2goZW50cnkgPT4ge1xuICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICAgIGVudHJ5LnRhcmdldC5jbGFzc0xpc3QuYWRkKCdqcy1tYXNrLWFuaW1hdGlvbicpO1xuICAgICAgICBvYnNlcnZlci51bm9ic2VydmUoZW50cnkudGFyZ2V0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBvYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihjYWxsYmFjaywgb3B0aW9ucyk7XG5cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNhbXBsZTAxX19pbWcnKS5mb3JFYWNoKGVsbSA9PiB7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShlbG0pO1xuICB9KTtcbn0pO1xuXG5cblxuXG4iLCJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2FtcGxlMDJfX2J1dHRvbicpO1xuICBcbiAgaWYgKGJ1dHRvbikge1xuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBidXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJykgPT09ICd0cnVlJztcbiAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAhaXNFeHBhbmRlZCk7XG4gICAgICBidXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHRleHRFbGVtZW50ID0gYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJy50ZXh0Jyk7XG4gICAgICBpZiAodGV4dEVsZW1lbnQpIHtcbiAgICAgICAgdGV4dEVsZW1lbnQudGV4dENvbnRlbnQgPSBpc0V4cGFuZGVkID8gJ01FTlUnIDogJ0NMT1NFJztcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSk7ICJdfQ==
